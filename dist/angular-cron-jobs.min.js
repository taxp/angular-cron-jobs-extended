/**
 * UI Component For Creating Cron Job Syntax To Send To Server
 * @version v1.3.3 - 2015-07-07 * @link https://github.com/jacobscarter/angular-cron-jobs
 * @author Jacob Carter <jacob@ieksolutions.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
angular.module("templates-angularcronjobs",["cronselection.html"]),angular.module("cronselection.html",[]).run(["$templateCache",function(a){a.put("cronselection.html",'<div class="cron-wrap">\n    <div>\n        <span class="left-col">Every: </span>\n        <select class="cron-select" ng-model="myFrequency.base" ng-options="item.value as item.label for item in frequency"></select>\n    </div>\n    <div>\n        <span class="left-col">Interval: </span>\n        <select class="cron-select" ng-model="myFrequency.interval" ng-options="interval for interval in intervalValues"></select>\n        <span ng-switch="myFrequency.base">\n            <span ng-switch-when="3"><span ng-if="myFrequency.interval == 1">day</span><span ng-if="myFrequency.interval > 1">days</span></span>\n            <span ng-switch-when="4"><span ng-if="myFrequency.interval == 1">week</span><span ng-if="myFrequency.interval > 1">weeks</span></span>\n            <span ng-switch-when="5"><span ng-if="myFrequency.interval == 1">month</span><span ng-if="myFrequency.interval > 1">months</span></span>\n            <span ng-switch-when="6"><span ng-if="myFrequency.interval == 1">year</span><span ng-if="myFrequency.interval > 1">years</span></span>\n        </span>\n    </div>\n	<div>\n		<span ng-show="myFrequency.base == 4" class="left-col">On: </span>\n\n        <span ng-show="myFrequency.base == 4">\n            <label ng-repeat="value in dayValue">\n                <input type="checkbox" value="value" name="weekdays[]" ng-checked="myFrequency.dayValue.indexOf(value) > -1" ng-click="toggleWeekday(value)">\n                {{value | shortDayName}}\n            </label>\n        </span>\n\n\n        <!--\n        <span ng-show="myFrequency.base >= 5">on the </span>\n		<select ng-show="myFrequency.base >= 5" class="cron-select day-of-month-value" ng-model="myFrequency.dayOfMonthValue" ng-options="(value | numeral) for value in dayOfMonthValue"></select>\n		<span ng-show="myFrequency.base == 6">of </span>\n		<select ng-show="myFrequency.base == 6" class="cron-select month-value" ng-model="myFrequency.monthValue" ng-options="(value | monthName) for value in monthValue"></select>\n		<span ng-show="myFrequency.base >= 2">at </span>\n		<select ng-show="myFrequency.base >= 3" class="cron-select hour-value" ng-model="myFrequency.hourValue" ng-options="value for value in hourValue"></select>\n		<span ng-show="myFrequency.base >= 3"> : </span>\n		<select ng-show="myFrequency.base >= 2" class="cron-select minute-value" ng-model="myFrequency.minuteValue" ng-options="value for value in minuteValue"></select>\n		<span ng-show="myFrequency.base == 2"> past the hour</span>\n		-->\n	</div>\n    <div>\n        <span class="left-col">Begin at: </span>\n        <input type="date" ng-model="myFrequency.beginDate">\n    </div>\n    <div>\n        <span class="left-col top">End at: </span>\n        <div class="inline-block">\n            <div>\n                <label>\n                    <input type="radio" value="1" ng-model="myFrequency.endType" />Never\n                </label>\n            </div>\n            <div>\n                <label>\n                    <input type="radio" value="2" ng-model="myFrequency.endType" />After\n                </label>\n                <input type="text" ng-model="myFrequency.endCount" ng-disabled="myFrequency.endType != \'2\'" />\n            </div>\n            <div>\n                <label>\n                    <input type="radio" value="3" ng-model="myFrequency.endType" />\n                </label>\n                <input type="date" ng-model="myFrequency.endDate" ng-disabled="myFrequency.endType != \'3\'" />\n            </div>\n        </div>\n    </div>\n</div>')}]),angular.module("angular-cron-jobs",["templates-angularcronjobs"]),angular.module("angular-cron-jobs").directive("cronSelection",["cronService",function(a){return{restrict:"EA",replace:!0,transclude:!0,scope:{config:"=",output:"=?",init:"=?"},templateUrl:function(a,b){return b.template||"cronselection.html"},link:function(b){var c=void 0,d=!1;if(b.frequency=[{value:1,label:"Minute"},{value:2,label:"Hour"},{value:3,label:"Day"},{value:4,label:"Week"},{value:5,label:"Month"},{value:6,label:"Year"}],angular.isDefined(b.init.cronString)&&(c=angular.copy(b.init),b.myFrequency=a.fromCron(b.init.cronString),b.myFrequency.beginDate=b.init.beginDate,b.myFrequency.endType=b.init.endType,b.myFrequency.endCount=b.init.endCount,b.myFrequency.endDate=b.init.endDate),b.$watch("init",function(e){angular.isDefined(e)&&e&&e!==c&&(d=!0,b.myFrequency=a.fromCron(b.init.cronString),b.myFrequency.beginDate=b.init.beginDate,b.myFrequency.endType=b.init.endType,b.myFrequency.endCount=b.init.endCount,b.myFrequency.endDate=b.init.endDate)}),"object"==typeof b.config&&!b.config.length){var e=Object.keys(b.config.options);for(var f in e)if(e.hasOwnProperty(f)){var g=e[f].replace(/^allow/,""),h=e[f];if(!b.config.options[h])for(var i in b.frequency)b.frequency.hasOwnProperty(i)&&b.frequency[i].label===g&&b.frequency.splice(i,1)}}b.minuteValue=[0,5,10,15,20,25,30,35,40,45,50,55],b.hourValue=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],b.dayOfMonthValue=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],b.dayValue=[0,1,2,3,4,5,6],b.monthValue=[1,2,3,4,5,6,7,8,9,10,11,12],b.intervalValues=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],b.$watch("myFrequency",function(c,e){!c||e&&c.base===e.base||d?c&&c.base&&e&&e.base&&(d=!1):(c&&c.base&&(c.base=parseInt(c.base)),c&&c.base&&c.base>=2&&(c.minuteValue=b.minuteValue[0]),c&&c.base&&c.base>=3&&(c.hourValue=b.hourValue[0]),c&&c.base&&4===c.base&&(c.dayValue=[b.dayValue[0]]),c&&c.base&&c.base>=5&&(c.dayOfMonthValue=b.dayOfMonthValue[0]),c&&c.base&&6===c.base&&(c.monthValue=b.monthValue[0]));var f=a.setCron(c);b.output={cronString:f,beginDate:c.beginDate,endType:c.endType,endCount:c.endCount,endDate:c.endDate}},!0),b.toggleWeekday=function(a){var c=b.myFrequency.dayValue.indexOf(a);c>-1?b.myFrequency.dayValue.splice(c,1):b.myFrequency.dayValue.push(a)}}}}]).filter("numeral",function(){return function(a){return null===a?null:-1!=[10,11,12,13].indexOf(a%100)?a+"th":a%10==1?a+"st":a%10==2?a+"nd":a%10==3?a+"rd":a+"th"}}).filter("monthName",function(){return function(a){var b={1:"January",2:"February",3:"March",4:"April",5:"May",6:"June",7:"July",8:"August",9:"September",10:"October",11:"November",12:"December"};return null!==a&&angular.isDefined(b[a])?b[a]:null}}).filter("dayName",function(){return function(a){var b={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"};return null!==a&&angular.isDefined(b[a])?b[a]:null}}).filter("shortDayName",function(){return function(a){var b={0:"Su",1:"Mo",2:"Tu",3:"We",4:"Th",5:"Fr",6:"Sa"};return null!==a&&angular.isDefined(b[a])?b[a]:null}}),angular.module("angular-cron-jobs").factory("cronService",function(){var a={};return a.setCron=function(a){var b=["*","*","*","*","*","*"];return a&&a.base&&a.base>=2&&(b[0]=void 0!==typeof a.minuteValue?a.minuteValue:"*"),a&&a.base&&a.base>=3&&(b[1]=void 0!==typeof a.hourValue?a.hourValue:"*",3===a.base&&a.interval&&(b[2]="*/"+a.interval)),a&&a.base&&4===a.base&&a.dayValue.length&&a.interval&&(b[6]=a.dayValue.join(",")+"/"+a.interval),a&&a.base&&5===a.base&&(b[2]=void 0!==typeof a.dayOfMonthValue?a.dayOfMonthValue:"1",a.interval&&(b[3]="*/"+a.interval)),a&&a.base&&6===a.base&&(b[2]=void 0!==typeof a.dayOfMonthValue?a.dayOfMonthValue:"1",b[3]=void 0!==typeof a.monthValue?a.monthValue:"1",b[5]="*/"+a.interval),b.join(" ")},a.fromCron=function(a){var b=a.replace(/\s+/g," ").split(" "),c={base:"1"};if("*"===b[0]&&"*"===b[1]&&"*"===b[2]&&"*"===b[3]&&"*"===b[4])c.base=1;else if("*"===b[1]&&"*"===b[2]&&"*"===b[3]&&"*"===b[4])c.base=2;else if("*"!==b[3]||"*"!==b[4]||void 0!=b[6]&&"*"!=b[6])if("*"===b[2]&&"*"===b[3]&&"*"===b[4]&&"*"===b[5]){c.base=4;var d=b[6].split("/")[0];c.interval=parseInt(b[6].split("/")[1]),"*"==d?c.dayValue=[1,2,3,4,5,6,7]:c.dayValue=d.split(",").map(function(a){return parseInt(a)})}else"*"===b[4]&&"*"===b[5]?(c.base=5,c.interval=parseInt(b[3].split("/")[1])):"*"===b[4]&&(c.base=6,c.interval=parseInt(b[5].split("/")[1]));else c.base=3,c.interval=parseInt(b[2].split("/")[1]);return"*"!==b[0]&&(c.minuteValue=parseInt(b[0])),"*"!==b[1]&&(c.hourValue=parseInt(b[1])),"*"===b[2]||isNaN(parseInt(b[2]))||(c.dayOfMonthValue=parseInt(b[2])),"*"===b[3]||isNaN(parseInt(b[3]))||(c.monthValue=parseInt(b[3])),"*"!==b[4],c},a});